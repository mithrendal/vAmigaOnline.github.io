import{S as Vt,i as Ft,s as Bt,E as o,o as Kt,F as a,G as jt,H as Zt,w as vt,e as ss,a as zt,I as $t,x as er,h as k,c as qt,y as sr,J as Jt,b as A,K as tr,L as rr,M as ar,f as ts,t as rs,z as or,k as as,q as Mr,l as os,m as Ms,r as cr,N as gr,n as nr,C as _r,O as Sr}from"../../chunks/paths-5da6ddf3.js";import{p as P,M as cs,a as gs,b as ns,c as _s,d as Ss,e as ps,f as us,g as Ds,h as Rs,i as bs,j as Es,k as ks,l as Os,m as Cs,n as ls,o as Gs,q as ms,r as is,s as As,t as Ps,u as ds,v as Ts,w as hs,x as Is,y as Ns,z as ys,A as Us,B as Hs,C as fs,D as ws,E as Ws,F as Ls,G as xs,H as Vs,I as Fs,J as Bs,K as Ks,L as js,N as zs,O as qs,P as Js,Q as Ys,R as Qs,S as Xs,T as Zs,U as vs,V as $s,W as et,X as st,Y as tt,Z as rt,_ as at,$ as ot,a0 as Mt,a1 as ct,a2 as gt,a3 as nt,a4 as _t,a5 as St,a6 as pt,a7 as ut,a8 as Dt,a9 as Rt,aa as bt,ab as Et,ac as kt,ad as Ot,ae as Ct,af as lt,ag as Gt,ah as mt,ai as it,aj as At,ak as Pt,al as i,am as dt,an as Tt,ao as Qe,ap as ht,aq as It,ar as Nt,as as yt,at as Ut,au as Ht,av as ft,aw as wt,ax as Wt,ay as Lt,az as pr}from"../../chunks/navigation-625c4572.js";function ur(r,n,t){let s,S,R,M,p,c,g,D,l,d,T,h,I,N,y,U,H,f,w,W,L,x,V,F,B,K,j,z,q,J,Y,Q,X,Z,v,$,ee,se,te,re,ae,oe,Me,ce,ge,ne,_e,Se,pe,ue,De,Re,be,Ee,ke,Oe,Ce,le,Ge,me,ie,Ae,Pe,de,Te,he,Ie,Ne,ye,Ue,He,fe,we,We,Le,O,xe,Ve,G,Fe,Be,Ke,je,ze,qe,m,Je,u,Ye;o(r,P,e=>t(6,s=e)),o(r,cs,e=>t(7,S=e)),o(r,gs,e=>t(8,R=e)),o(r,ns,e=>t(9,M=e)),o(r,_s,e=>t(10,p=e)),o(r,Ss,e=>t(11,c=e)),o(r,ps,e=>t(12,g=e)),o(r,us,e=>t(13,D=e)),o(r,Ds,e=>t(14,l=e)),o(r,Rs,e=>t(15,d=e)),o(r,bs,e=>t(16,T=e)),o(r,Es,e=>t(17,h=e)),o(r,ks,e=>t(18,I=e)),o(r,Os,e=>t(19,N=e)),o(r,Cs,e=>t(20,y=e)),o(r,ls,e=>t(21,U=e)),o(r,Gs,e=>t(22,H=e)),o(r,ms,e=>t(23,f=e)),o(r,is,e=>t(24,w=e)),o(r,As,e=>t(25,W=e)),o(r,Ps,e=>t(26,L=e)),o(r,ds,e=>t(27,x=e)),o(r,Ts,e=>t(28,V=e)),o(r,hs,e=>t(29,F=e)),o(r,Is,e=>t(30,B=e)),o(r,Ns,e=>t(31,K=e)),o(r,ys,e=>t(32,j=e)),o(r,Us,e=>t(33,z=e)),o(r,Hs,e=>t(34,q=e)),o(r,fs,e=>t(35,J=e)),o(r,ws,e=>t(36,Y=e)),o(r,Ws,e=>t(37,Q=e)),o(r,Ls,e=>t(38,X=e)),o(r,xs,e=>t(39,Z=e)),o(r,Vs,e=>t(40,v=e)),o(r,Fs,e=>t(41,$=e)),o(r,Bs,e=>t(42,ee=e)),o(r,Ks,e=>t(43,se=e)),o(r,js,e=>t(44,te=e)),o(r,zs,e=>t(45,re=e)),o(r,qs,e=>t(46,ae=e)),o(r,Js,e=>t(47,oe=e)),o(r,Ys,e=>t(48,Me=e)),o(r,Qs,e=>t(49,ce=e)),o(r,Xs,e=>t(50,ge=e)),o(r,Zs,e=>t(51,ne=e)),o(r,vs,e=>t(52,_e=e)),o(r,$s,e=>t(53,Se=e)),o(r,et,e=>t(54,pe=e)),o(r,st,e=>t(55,ue=e)),o(r,tt,e=>t(56,De=e)),o(r,rt,e=>t(57,Re=e)),o(r,at,e=>t(58,be=e)),o(r,ot,e=>t(59,Ee=e)),o(r,Mt,e=>t(60,ke=e)),o(r,ct,e=>t(61,Oe=e)),o(r,gt,e=>t(62,Ce=e)),o(r,nt,e=>t(63,le=e)),o(r,_t,e=>t(64,Ge=e)),o(r,St,e=>t(65,me=e)),o(r,pt,e=>t(66,ie=e)),o(r,ut,e=>t(67,Ae=e)),o(r,Dt,e=>t(68,Pe=e)),o(r,Rt,e=>t(69,de=e)),o(r,bt,e=>t(70,Te=e)),o(r,Et,e=>t(71,he=e)),o(r,kt,e=>t(72,Ie=e)),o(r,Ot,e=>t(73,Ne=e)),o(r,Ct,e=>t(74,ye=e)),o(r,lt,e=>t(75,Ue=e)),o(r,Gt,e=>t(76,He=e)),o(r,mt,e=>t(77,fe=e)),o(r,it,e=>t(78,we=e)),o(r,At,e=>t(79,We=e)),o(r,Pt,e=>t(80,Le=e)),o(r,i,e=>t(81,O=e)),o(r,dt,e=>t(82,xe=e)),o(r,Tt,e=>t(83,Ve=e)),o(r,Qe,e=>t(84,G=e)),o(r,ht,e=>t(85,Fe=e)),o(r,It,e=>t(86,Be=e)),o(r,Nt,e=>t(87,Ke=e)),o(r,yt,e=>t(88,je=e)),o(r,Ut,e=>t(89,ze=e)),o(r,Ht,e=>t(90,qe=e)),o(r,ft,e=>t(91,m=e)),o(r,wt,e=>t(92,Je=e)),o(r,Wt,e=>t(93,u=e)),o(r,Lt,e=>t(94,Ye=e));let{audioContext:b=null}=n;Kt(()=>{console.log("Proxy: onMount()"),a(P,s.processMsg=Xt,s)});async function Xe(){if(b!=null){console.log("Audio context already initialized");return}t(0,b=new AudioContext);const e=b.sampleRate;console.log("Sample rate = "+e),console.log("Channels: ",b.destination.channelCount),u.setSampleRate(b.sampleRate),console.log("Adding audio processor..."),await b.audioWorklet.addModule("js/audio-processor.js"),console.log("Creating audio node...");const _=new AudioWorkletNode(b,"audio-processor",{outputChannelCount:[2]});_.port.onmessage=C=>{C.data,u.updateAudio(C.data)},_.connect(b.destination);const E=[u.leftChannelBuffer(),u.rightChannelBuffer()];_.port.postMessage({cmd:"bind",pointers:E,buffer:s.HEAPF32.buffer,length:1024})}async function Yt(e){console.log("Setting up audio..."),await Xe();try{console.log("Running "+e.title+"..."),u.powerOff(),console.log("Configuring CHIP: "+e.memory[0]),u.configure(s.OPT_CHIP_RAM,e.memory[0]),console.log("Configuring SLOW: "+e.memory[1]),u.configure(s.OPT_SLOW_RAM,e.memory[1]),console.log("Configuring FAST: "+e.memory[2]),u.configure(s.OPT_FAST_RAM,e.memory[2]);for(let _=0;_<e.adf.length;_++)console.log("Inserting disk "+_+": "+e.adf[_]),await ve(e.adf[_],_);u.run()}catch(_){console.log("CATCHED"+_)}pr(jt+"/emulator")}function Ze(){console.error("Exception "+u.errorCode()+": "+u.what())}async function ve(e,_){try{console.log("Fetching adf/"+e);let C=await(await fetch("adf/"+e)).arrayBuffer(),es=new Uint8Array(C);console.log("Calling $amiga.insertDisk"),u.insertDisk(es,C.byteLength,_)}catch{Ze()}}async function $e(){console.log("VAmiga: startUp()");try{let e=await fetch("roms/aros-svn55696-rom.bin"),_=await e.arrayBuffer(),E=new Uint8Array(_);m.loadRom(E,_.byteLength),e=await fetch("roms/aros-svn55696-ext.bin"),_=await e.arrayBuffer(),E=new Uint8Array(_),m.loadExt(E,_.byteLength)}catch{Ze()}}function Qt(){console.log("Creating proxies..."),a(Lt,Ye=new s.EnumProxy,Ye),a(Wt,u=new s.AmigaProxy,u),a(wt,Je=new s.DeniseProxy,Je),a(ft,m=new s.MemoryProxy,m),a(Ht,qe=new s.RetroShellProxy,qe),$e()}function Xt(e,_,E,C,es){switch(e){case s.MSG_NONE:a(Ut,ze++,ze);break;case s.MSG_REGISTER:a(yt,je++,je);break;case s.MSG_CONFIG:a(Nt,Ke++,Ke);break;case s.MSG_POWER_ON:a(It,Be++,Be),a(Qe,G=!0,G);break;case s.MSG_POWER_OFF:a(ht,Fe++,Fe),a(Qe,G=!1,G),a(i,O=!1,O);break;case s.MSG_RUN:a(Tt,Ve++,Ve),a(i,O=!0,O);break;case s.MSG_PAUSE:a(dt,xe++,xe),a(i,O=!1,O);break;case s.MSG_STEP:a(Pt,Le++,Le);break;case s.MSG_RESET:a(At,We++,We);break;case s.MSG_HALT:a(it,we++,we);break;case s.MSG_ABORT:a(mt,fe++,fe);break;case s.MSG_WARP_ON:a(Gt,He++,He);break;case s.MSG_WARP_OFF:a(lt,Ue++,Ue);break;case s.MSG_DEBUG_ON:a(Ct,ye++,ye);break;case s.MSG_DEBUG_OFF:a(Ot,Ne++,Ne);break;case s.MSG_MUTE_ON:a(kt,Ie++,Ie);break;case s.MSG_MUTE_OFF:a(Et,he++,he);break;case s.MSG_POWER_LED_ON:a(bt,Te++,Te);break;case s.MSG_POWER_LED_DIM:a(Rt,de++,de);break;case s.MSG_POWER_LED_OFF:a(Dt,Pe++,Pe);break;case s.MSG_CLOSE_CONSOLE:a(ut,Ae++,Ae);break;case s.MSG_UPDATE_CONSOLE:a(pt,ie++,ie);break;case s.MSG_SCRIPT_DONE:a(St,me++,me);break;case s.MSG_SCRIPT_PAUSE:a(_t,Ge++,Ge);break;case s.MSG_SCRIPT_ABORT:a(nt,le++,le);break;case s.MSG_SCRIPT_WAKEUP:a(gt,Ce++,Ce);break;case s.MSG_VIDEO_FORMAT:a(ct,Oe++,Oe);break;case s.MSG_OVERCLOCKING:a(Mt,ke++,ke);break;case s.MSG_BREAKPOINT_REACHED:a(ot,Ee++,Ee);break;case s.MSG_BREAKPOINT_UPDATED:a(at,be++,be);break;case s.MSG_WATCHPOINT_REACHED:a(rt,Re++,Re);break;case s.MSG_WATCHPOINT_UPDATED:a(tt,De++,De);break;case s.MSG_CATCHPOINT_REACHED:a(st,ue++,ue);break;case s.MSG_CATCHPOINT_UPDATED:a(et,pe++,pe);break;case s.MSG_SWTRAP_REACHED:a($s,Se++,Se);break;case s.MSG_CPU_HALT:a(vs,_e++,_e);break;case s.MSG_COPPERBP_REACHED:a(Zs,ne++,ne);break;case s.MSG_COPPERBP_UPDATED:a(Xs,ge++,ge);break;case s.MSG_COPPERWP_REACHED:a(Qs,ce++,ce);break;case s.MSG_COPPERWP_UPDATED:a(Ys,Me++,Me);break;case s.MSG_VIEWPORT:a(Js,oe++,oe);break;case s.MSG_MEM_LAYOUT:a(qs,ae++,ae);break;case s.MSG_DRIVE_CONNECT:a(zs,re++,re);break;case s.MSG_DRIVE_DISCONNECT:a(js,te++,te);break;case s.MSG_DRIVE_SELECT:a(Ks,se++,se);break;case s.MSG_DRIVE_READ:a(Bs,ee++,ee);break;case s.MSG_DRIVE_WRITE:a(Fs,$++,$);break;case s.MSG_DRIVE_LED_ON:a(Vs,v++,v);break;case s.MSG_DRIVE_LED_OFF:a(xs,Z++,Z);break;case s.MSG_DRIVE_MOTOR_ON:a(Ls,X++,X);break;case s.MSG_DRIVE_MOTOR_OFF:a(Ws,Q++,Q);break;case s.MSG_DRIVE_STEP:a(ws,Y++,Y);break;case s.MSG_DRIVE_POLL:a(fs,J++,J);break;case s.MSG_DISK_INSERT:a(Hs,q++,q);break;case s.MSG_DISK_EJECT:a(Us,z++,z);break;case s.MSG_DISK_SAVED:a(ys,j++,j);break;case s.MSG_DISK_UNSAVED:a(Ns,K++,K);break;case s.MSG_DISK_PROTECT:a(Is,B++,B);break;case s.MSG_DISK_UNPROTECT:a(hs,F++,F);break;case s.MSG_HDC_CONNECT:a(Ts,V++,V);break;case s.MSG_HDC_DISCONNECT:a(ds,x++,x);break;case s.MSG_HDC_STATE:a(Ps,L++,L);break;case s.MSG_HDR_STEP:a(As,W++,W);break;case s.MSG_HDR_READ:a(is,w++,w);break;case s.MSG_HDR_WRITE:a(ms,f++,f);break;case s.MSG_HDR_IDLE:a(Gs,H++,H);break;case s.MSG_CTRL_AMIGA_AMIGA:a(ls,U++,U);break;case s.MSG_SHAKING:a(Cs,y++,y);break;case s.MSG_SER_IN:a(Os,N++,N);break;case s.MSG_SER_OUT:a(ks,I++,I);break;case s.MSG_AUTO_SNAPSHOT_TAKEN:a(Es,h++,h);break;case s.MSG_USER_SNAPSHOT_TAKEN:a(bs,T++,T);break;case s.MSG_SNAPSHOT_RESTORED:a(Rs,d++,d);break;case s.MSG_RECORDING_STARTED:a(Ds,l++,l);break;case s.MSG_RECORDING_STOPPED:a(us,D++,D);break;case s.MSG_RECORDING_ABORTED:a(ps,g++,g);break;case s.MSG_DMA_DEBUG_ON:a(Ss,c++,c);break;case s.MSG_DMA_DEBUG_OFF:a(_s,p++,p);break;case s.MSG_SRV_STATE:a(ns,M++,M);break;case s.MSG_SRV_RECEIVE:a(gs,R++,R);break;case s.MSG_SRV_SEND:a(cs,S++,S);break}}return r.$$set=e=>{"audioContext"in e&&t(0,b=e.audioContext)},[b,Xe,Yt,ve,$e,Qt]}class Dr extends Vt{constructor(n){super(),Ft(this,n,ur,null,Bt,{audioContext:0,setupAudio:1,runShowcase:2,insert:3,startUp:4,onRuntimeInitialized:5},null,[-1,-1,-1,-1])}get setupAudio(){return this.$$.ctx[1]}get runShowcase(){return this.$$.ctx[2]}get insert(){return this.$$.ctx[3]}get startUp(){return this.$$.ctx[4]}get onRuntimeInitialized(){return this.$$.ctx[5]}}function xt(r){let n,t,s,S,R;return{c(){n=as("script"),t=Mr("console.log('Loading vAmiga.js');"),s=zt(),S=as("script"),this.h()},l(M){n=os(M,"SCRIPT",{});var p=Ms(n);t=cr(p,"console.log('Loading vAmiga.js');"),p.forEach(k),s=qt(M),S=os(M,"SCRIPT",{src:!0});var c=Ms(S);c.forEach(k),this.h()},h(){gr(S.src,R=jt+"/vAmiga.js")||nr(S,"src",R)},m(M,p){A(M,n,p),Jt(n,t),A(M,s,p),A(M,S,p)},p:_r,d(M){M&&k(n),M&&k(s),M&&k(S)}}}function Rr(r){let n,t,s,S,R={};n=new Dr({props:R}),r[4](n);let M=r[0]&&xt();const p=r[3].default,c=Zt(p,r,r[2],null);return{c(){vt(n.$$.fragment),M&&M.c(),t=ss(),s=zt(),c&&c.c()},l(g){const D=$t("svelte-1azv35z",document.head);er(n.$$.fragment,D),M&&M.l(D),t=ss(),D.forEach(k),s=qt(g),c&&c.l(g)},m(g,D){sr(n,document.head,null),M&&M.m(document.head,null),Jt(document.head,t),A(g,s,D),c&&c.m(g,D),S=!0},p(g,[D]){const l={};n.$set(l),g[0]?M?M.p(g,D):(M=xt(),M.c(),M.m(t.parentNode,t)):M&&(M.d(1),M=null),c&&c.p&&(!S||D&4)&&tr(c,p,g,g[2],S?ar(p,g[2],D,null):rr(g[2]),null)},i(g){S||(ts(n.$$.fragment,g),ts(c,g),S=!0)},o(g){rs(n.$$.fragment,g),rs(c,g),S=!1},d(g){r[4](null),or(n),M&&M.d(g),k(t),g&&k(s),c&&c.d(g)}}}function br(r,n,t){let s;o(r,P,c=>t(1,s=c));let{$$slots:S={},$$scope:R}=n,M=!1;Kt(()=>{console.log("+layout: onMount()"),window.Module=s,t(0,M=!0)});function p(c){Sr[c?"unshift":"push"](()=>{s=c,P.set(s)})}return r.$$set=c=>{"$$scope"in c&&t(2,R=c.$$scope)},[M,s,R,S,p]}class Or extends Vt{constructor(n){super(),Ft(this,n,br,Rr,Bt,{})}}export{Or as default};
